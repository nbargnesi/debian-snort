#!/bin/sh -e

. /usr/share/debconf/confmodule

db_input low snort-mysql/startup || true
db_go

# /etc/ppp/ip-up.d/snort-mysql is called with interface and IP number
db_get snort-mysql/startup
if [ "x$RET" = "xdialup" ]; then
  db_set snort-mysql/interface ""
  db_set snort-mysql/address_range ""
  db_set snort-mysql/disable_promiscuous true
else
  db_beginblock
  db_input medium snort-mysql/interface || true
  db_input high snort-mysql/address_range || true
  db_input low snort-mysql/disable_promiscuous || true
  db_endblock
  db_go
fi

db_beginblock
db_input low snort-mysql/reverse_order || true
db_input low snort-mysql/options || true
db_endblock
db_go

db_beginblock
db_input medium snort-mysql/stats_rcpt || true
db_input low snort-mysql/stats_treshold || true
db_endblock
db_go

db_input high snort-mysql/configure_db || true
db_go
db_get snort-mysql/configure_db
if  [ "x$RET" = "xtrue" ]; then
	db_beginblock
	db_input medium snort-mysql/db_host || true
	db_input medium snort-mysql/db_database || true
	db_input medium snort-mysql/db_user || true
	db_input medium snort-mysql/db_pass || true
	db_input medium snort-mysql/wait_for_db_config || true
	db_endblock
	db_go
fi

db_get snort-mysql/startup
if [ "x$RET" = "xmanual" ]; then
	db_beginblock
	db_input medium snort-mysql/please_restart_manually || true
	db_endblock
	db_go
fi

db_stop
